<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>地震情報</title>
</head>
<body>
    <h1>地震情報（最新）</h1>
    <div id="display">データを読み込み中...</div>

    <script>
        // 別のプロキシ「AllOrigins」を使用します
        // このプロキシは ?url= を使ってターゲットを指定します
        const targetUrl = "api.wolfx.jp/jma_eew.json";
        const proxyUrl = `api.allorigins.win{encodeURIComponent(targetUrl)}`;

        async function getEEW() {
            try {
                const response = await fetch(proxyUrl);
                
                if (!response.ok) {
                    throw new Error(`プロキシエラー: ${response.status}`);
                }
                
                const json = await response.json();
                
                // AllOrigins は元のデータを「contents」という文字列の中に隠して返すので
                // それを JSON.parse で解析して変数 API に入れます
                const API = JSON.parse(json.contents);
                
                console.log("取得成功:", API);

                // 画面に表示
                document.getElementById('display').innerText = 
                    `発表時刻: ${API.AnnouncedTime || 'データなし'}\n` +
                    `震源地: ${API.Hypocenter || '情報なし'}\n` +
                    `マグニチュード: ${API.Magunitude || '不明'}\n` +
                    `最大震度: ${API.Intensity || '不明'}`;

            } catch (error) {
                document.getElementById('display').innerHTML = 
                    `<p style="color:red;">エラー: ${error.message}</p>` +
                    `<p>※プロキシを切り替えてもエラーが出る場合は、API側のURLが一時的にダウンしている可能性があります。</p>`;
            }
        }

        getEEW();
    </script>
</body>
</html>
